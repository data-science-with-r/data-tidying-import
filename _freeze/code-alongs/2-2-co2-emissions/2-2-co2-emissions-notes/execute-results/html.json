{
  "hash": "a5ad18e894eb3e45ead823bd6053221d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Halving CO2 emissions\"\nfig-width: 6\nfig-asp: 0.618\n---\n\n\n\n\n# Introduction\n\nVisitors to Gapminder.org are welcomed with a question about common misconceptions.\nHere is one of them.\n\n![](images/gapminder-co2-questions.png)\n\nOnce you make your selection, you are directed to a page that explains the right answer and shows a visualization of the distribution of responses from various countries.\n\n![](images/gapminder-co2-answers.png)\n\nOur goal is to create a version of this visualization.\n\n## Packages\n\nWe will use the **tidyverse** and **scales** packages for data wrangling and visualization.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(scales)\n```\n:::\n\n\n\n\n## Data\n\nThe data we're going to use is in a CSV file called `co2-emissions.csv` at <https://data-science-with-r.github.io/data/co2-emissions.csv>.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions <- read_csv(\"https://data-science-with-r.github.io/data/co2-emissions.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 8 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): country\ndbl (3): Very wrong, Wrong, Correct\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n\nAnd let's take a look at the data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 4\n  country        `Very wrong` Wrong Correct\n  <chr>                 <dbl> <dbl>   <dbl>\n1 Türkiye                  61    23      16\n2 Columbia                 64    16      20\n3 Sweden                   36    35      29\n4 Germany                  26    41      33\n5 United Kingdom           29    37      34\n6 United States            31    32      37\n7 Kenya                    46     8      46\n8 Pakistan                 37    13      50\n```\n\n\n:::\n:::\n\n\n\n\n-   Pivot the `co2_emissions` data frame *longer* such that each row represents a country / answer type combination and `answer_type` and `percentage` for that country are columns in the data frame.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions_longer <- co2_emissions |>\n  pivot_longer(\n    cols = !country,\n    names_to = \"answer_type\",\n    values_to = \"percentage\"\n  )\n```\n:::\n\n\n\n\n-   Create a stacked bar plot of response type by countries.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(co2_emissions_longer, aes(x = percentage, y = country, fill = answer_type)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](2-2-co2-emissions-notes_files/figure-html/unnamed-chunk-5-1.png){width=576}\n:::\n:::\n\n\n\n\n-   In the original plot, the levels of `answer_type` are in the order Very wrong, Wrong, and Correct. Update the previous plot reorder the levels in this order.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions_longer |>\n  mutate(answer_type = fct_relevel(answer_type, \"Very wrong\", \"Wrong\", \"Correct\")) |>\n  ggplot(aes(x = percentage, y = country, fill = answer_type)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](2-2-co2-emissions-notes_files/figure-html/unnamed-chunk-6-1.png){width=576}\n:::\n:::\n\n\n\n\n-   Update the colors of the plot to match the original plot:\n    -   Very wrong: #96283A\n    -   Wrong: #DB4C67\n    -   Correct: #C8F0BF\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions_longer |>\n  mutate(answer_type = fct_relevel(answer_type, \"Correct\", \"Wrong\", \"Very wrong\")) |>\n  ggplot(aes(x = percentage, y = country, fill = answer_type)) +\n  geom_col() +\n  scale_fill_manual(\n    values = c(\n      \"Very wrong\" = \"#96283A\",\n      \"Wrong\" = \"#DB4C67\",\n      \"Correct\" = \"#C8F0BF\"   \n    )\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](2-2-co2-emissions-notes_files/figure-html/unnamed-chunk-7-1.png){width=576}\n:::\n:::\n\n\n\n\n-   Move the legend to the bottom and make sure the levels appear in the same order they appear in the plot.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions_longer |>\n  mutate(answer_type = fct_relevel(answer_type, \"Correct\", \"Wrong\", \"Very wrong\")) |>\n  ggplot(aes(x = percentage, y = country, fill = answer_type)) +\n  geom_col() +\n  scale_fill_manual(\n    values = c(\n      \"Very wrong\" = \"#96283A\",\n      \"Wrong\" = \"#DB4C67\",\n      \"Correct\" = \"#C8F0BF\"   \n    ),\n    guide = guide_legend(reverse = TRUE)\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](2-2-co2-emissions-notes_files/figure-html/unnamed-chunk-8-1.png){width=576}\n:::\n:::\n\n\n\n\n-   Reorder countries to match the original plot -- in increasing order of corect percentages.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions_longer |>\n  mutate(\n    answer_type = fct_relevel(answer_type, \"Correct\", \"Wrong\", \"Very wrong\"),\n    country = fct_rev(fct_relevel(country, \"Türkiye\", \"Columbia\", \"Sweden\", \"Germany\", \"United Kingdom\", \"United States\", \"Kenya\", \"Pakistan\"))\n  ) |>\n  ggplot(aes(x = percentage, y = country, fill = answer_type)) +\n  geom_col() +\n  scale_fill_manual(\n    values = c(\n      \"Very wrong\" = \"#96283A\",\n      \"Wrong\" = \"#DB4C67\",\n      \"Correct\" = \"#C8F0BF\"   \n    ),\n    guide = guide_legend(reverse = TRUE)\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](2-2-co2-emissions-notes_files/figure-html/unnamed-chunk-9-1.png){width=576}\n:::\n:::\n\n\n\n\n-   Updte labels and other elements of the plot to get it closer to the original plot.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_emissions_longer |>\n  mutate(\n    answer_type = fct_relevel(answer_type, \"Correct\", \"Wrong\", \"Very wrong\"),\n    country = fct_rev(fct_relevel(country, \"Türkiye\", \"Columbia\", \"Sweden\", \"Germany\", \"United Kingdom\", \"United States\", \"Kenya\", \"Pakistan\"))\n  ) |>\n  ggplot(aes(x = percentage, y = country, fill = answer_type)) +\n  geom_col() +\n  scale_fill_manual(\n    values = c(\n      \"Very wrong\" = \"#96283A\",\n      \"Wrong\" = \"#DB4C67\",\n      \"Correct\" = \"#C8F0BF\"   \n    ),\n    guide = guide_legend(reverse = TRUE)\n  ) +\n  scale_x_continuous(labels = label_percent(scale = 1)) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\") +\n  labs(\n    fill = NULL,\n    title = \"Survey Results\",\n    subtitle = \"Of the people we have tested, 67% got this question wrong.\",\n    x = NULL, y = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](2-2-co2-emissions-notes_files/figure-html/unnamed-chunk-10-1.png){width=576}\n:::\n:::\n",
    "supporting": [
      "2-2-co2-emissions-notes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}